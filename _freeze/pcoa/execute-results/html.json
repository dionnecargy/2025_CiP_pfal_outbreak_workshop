{
  "hash": "19fb858dc3b1a48a57ae8fd2278dd0d6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"PcoA\"\neditor: visual\noutput:\n  html_document:\n    toc: true\n    toc_float: true\n    number_sections: false\n---\n\n\n\n## 3. Convert to Genlight and Add Metadata\n\nBefore we can explore population structure, we need to convert the file format so our packages can run the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeta <- read.table(\"data/metadata_samples.txt\", header = TRUE, sep = \"\\t\", stringsAsFactors = FALSE)\nvcf_filt_SEA <- readRDS(\"derived/vcf_filt_SEA.rds\")\n\ngl_SEA <- vcfR2genlight(vcf_filt_SEA)\n\n# Make sure the order of samples in meta matches genlight individuals\nmeta_ord <- meta[match(indNames(gl_SEA), meta$sample), ]\nsaveRDS(meta_ord, file = \"derived/meta_ord.rds\")\n\nstopifnot(all(meta_ord$sample == indNames(gl_SEA)))\n\n# Assign populations by country\npop(gl_SEA) <- meta_ord$country\n\ngl_SEA\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n /// GENLIGHT OBJECT /////////\n\n // 90 genotypes,  191 binary SNPs, size: 166.6 Kb\n 1620 (9.42 %) missing data\n\n // Basic content\n   @gen: list of 90 SNPbin\n\n // Optional content\n   @ind.names:  90 individual labels\n   @loc.names:  191 locus labels\n   @chromosome: factor storing chromosomes of the SNPs\n   @position: integer storing positions of the SNPs\n   @pop: population of each individual (group size range: 30-30)\n   @other: a list containing: elements without names \n```\n\n\n:::\n\n```{.r .cell-code}\n# optional save\nsaveRDS(gl_SEA, file = \"derived/gl_SEA.rds\")\n```\n:::\n\n\n## 4. PCoA / MDS Plot (Population Structure)\n\n::: callout-note\n### Exercises for Section 4. PCoA / MDS Plot (Population Structure)\n\n-   What patterns do you observe in this section?\n-   Which samples or populations stand out?\n-   What does this tell you about the population structure?\n-   Why do we use PCoA plots?\n\nOther tasks: - Use ggplot2 (<https://ggplot2.tidyverse.org/)> to change colours or change the shapes of the countries. - What happens if you change the data to sites?\n\nEnsure you generate PCoA for both SEA and ARF datasets!\n:::\n\n### Principal Coordinates Analysis (PCoA)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist_mat_SEA <- dist(as.matrix(gl_SEA))\n#optional save\nsaveRDS(dist_mat_SEA, file = \"derived/dist_mat_SEA.rds\")\n\npcoa_res <- cmdscale(dist_mat_SEA, k = 2)\npcoa_df <- data.frame(pcoa_res, country = pop(gl_SEA))\n\npcoa <- ggplot(pcoa_df, aes(X1, X2, color = country)) +\n  geom_point(size = 3) +\n  theme_minimal() +\n  scale_color_viridis_d() +\n  labs(title = \"PCoA of 180-SNP Genotypes\", x = \"Coordinate 1\", y = \"Coordinate 2\")\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Click to see plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](pcoa_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n:::\n\n\n### **What PCoA Does?**\n\n-   Converts genetic distances between samples into a visual 2-D or 3-D space.\n\n-   Places genetically similar samples closer together, and genetically different samples farther apart.\n\n-   Helps uncover population structure, clusters, admixture, and outliers.\n\n### **Why Itâ€™s Useful for This Workshop**\n\n-   Shows whether the Namibia samples form a tight cluster (suggesting an outbreak from a common source).\n\n-   Reveals where the outbreak is genetically similar to.\n\n-   Quickly distinguishes regional genetic signatures (SEA vs Southern Africa vs West Africa).\n\n### **Strengths**\n\n-   Very fast, works on large datasets.\n\n-   Makes complex multidimensional relationships easy to interpret.\n\n-   No model assumptions (unlike PCA which assumes linearity).\n\n-   Great for teaching and preliminary exploration.\n\n### **Weaknesses**\n\n-   The axes are often hard to interpret biologically.\n\n-   Sensitive to missing data and distance metric choice.\n\n-   Does not explicitly model ancestry or evolution.\n\n-   Clusters can appear clearer or blurrier depending on scaling\n",
    "supporting": [
      "pcoa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}