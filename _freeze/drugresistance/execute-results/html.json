{
  "hash": "c9f917a7ad933e02c739d8a891da7b14",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Drug Resistance\"\neditor: visual\noutput:\n  html_document:\n    toc: true\n    toc_float: true\n    number_sections: false\n---\n\n\n\n## 10. Drug-Resistance Mutation Exploration\n\n::: callout-note\n### Exercises for Section 10. Drug-Resistance Mutation Exploration\n\n-   What does this plot tell us?\n-   Do any of the samples have any other mutations? How can you tell?\n:::\n\n### 10.1. C580Y prevalence by country\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndr_c580 <- meta %>%\n  group_by(country, kelch13_C580Y) %>%\n  summarise(n = n(), .groups = \"drop\") %>%\n  group_by(country) %>%\n  mutate(freq = n / sum(n))\n\nprev_plot <- ggplot(dr_c580, aes(x = country, y = freq, fill = kelch13_C580Y)) +\n  geom_col(position = \"stack\") +\n  scale_fill_manual(values = c(\"WT\" = \"grey80\", \"Y\" = \"firebrick\")) +\n  theme_minimal() +\n  coord_flip() +\n  labs(title = \"C580Y Prevalence by Country\",\n       x = \"Country\", y = \"Proportion\",\n       fill = \"kelch13 C580Y\")\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Click to see plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](drugresistance_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n:::\n\n### 10.2. Drug resistance mutation heatmap by country\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndr_cols <- c(\"kelch13_C580Y\",\n             \"crt_N75E\",\"crt_K76T\",\"crt_I356T\",\n             \"mdr1_N86Y\",\"mdr1_Y184F\",\n             \"dhfr_N51I\",\"dhfr_C59R\",\"dhfr_S108N\",\n             \"dhps_A437G\",\"dhps_K540E\")\n\ndr_long <- meta %>%\n  select(country, all_of(dr_cols)) %>%\n  pivot_longer(cols = all_of(dr_cols), names_to = \"marker\", values_to = \"aa\") %>%\n  group_by(country, marker) %>%\n  summarise(prop_mut = mean(aa != \"WT\"), .groups = \"drop\")\n\nheatmap <- ggplot(dr_long, aes(x = marker, y = country, fill = prop_mut)) +\n  geom_tile(color = \"white\") +\n  scale_fill_viridis_c(labels = percent_format(accuracy = 1)) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(title = \"Proportion of Mutant DR Alleles by Country\",\n       x = \"Drug-Resistance Marker\", y = \"Country\",\n       fill = \"Mutant\nproportion\")\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Click to see plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](drugresistance_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n:::\n\n\n### 10.3. Map coloured by C580Y status\n\n-   What does this tell us about the imported cases?\n-   You may need to change the size of the plot, points etc. to see the full picture.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeta$C580Y_status <- ifelse(meta$kelch13_C580Y == \"Y\", \"C580Y mutant\", \"WT\")\n\nC580Yplot <- ggplot() +\n  geom_sf(data = world, fill = \"grey95\", color = \"grey80\") +\n  geom_point(data = meta,\n             aes(x = longitude, y = latitude, color = C580Y_status),\n             size = 2, alpha = 0.9) +\n  coord_sf(xlim = c(-20, 120), ylim = c(-25, 25), expand = FALSE) +\n  scale_color_manual(values = c(\"WT\" = \"grey40\", \"C580Y mutant\" = \"firebrick\")) +\n  theme_minimal() +\n  labs(title = \"Geographic Distribution of kelch13 C580Y\",\n       x = \"Longitude\", y = \"Latitude\",\n       color = \"C580Y status\")\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Click to see plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](drugresistance_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n:::\n\n::: callout-important\nCan you find out information about any other important drug resistance genes?\n\n1.  Kelch13\n2.  mdr1\n3.  dhfr\n4.  dhps\n5.  crt\n:::\n",
    "supporting": [
      "drugresistance_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}