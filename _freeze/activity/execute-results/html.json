{
  "hash": "5c071767850b4d55afa811a13292742a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity\"\neditor: visual\noutput:\n  html_document:\n    toc: true\n    toc_float: true\n    number_sections: false\n---\n\n\n\n## Activity: Merge the datasets together and plot the PCoA and phylogenetic trees\n\n::: callout-note\n-   What do these plots tell us about imported cases?\n-   Do you have an idea on where the parasites have come from?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstopifnot(all(vcf_filt_SEA@fix[, \"ID\"] == vcf_filt_AFR@fix[, \"ID\"]))\n\nvcf_filt_merged <- vcf_filt_SEA\nvcf_filt_merged@gt <- cbind(\n  vcf_filt_SEA@gt,\n  vcf_filt_AFR@gt[, -1, drop = FALSE]  # drop AFR \"FORMAT\" column\n)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngl_all <- vcfR2genlight(vcf_filt_merged)\n\n# Make sure the order of samples in meta matches genlight individuals\nmeta_ord <- meta[match(indNames(gl_all), meta$sample), ]\nstopifnot(all(meta_ord$sample == indNames(gl_all)))\n\n# Assign populations by country\npop(gl_all) <- meta_ord$country\n\nsaveRDS(gl_all, file = \"derived/gl_all.rds\")\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Click to see output\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n /// GENLIGHT OBJECT /////////\n\n // 400 genotypes,  191 binary SNPs, size: 679.4 Kb\n 7200 (9.42 %) missing data\n\n // Basic content\n   @gen: list of 400 SNPbin\n\n // Optional content\n   @ind.names:  400 individual labels\n   @loc.names:  191 locus labels\n   @chromosome: factor storing chromosomes of the SNPs\n   @position: integer storing positions of the SNPs\n   @pop: population of each individual (group size range: 20-200)\n   @other: a list containing: elements without names \n```\n\n\n:::\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist_mat_all <- dist(as.matrix(gl_all))\n#optional save\nsaveRDS(dist_mat_all, file = \"derived/dist_mat_all.rds\")\n\npcoa_res <- cmdscale(dist_mat_all, k = 2)\npcoa_df <- data.frame(pcoa_res, country = pop(gl_all))\n\npcoa_all <- ggplot(pcoa_df, aes(X1, X2, color = country)) +\n  geom_point(size = 3) +\n  theme_minimal() +\n  scale_color_viridis_d() +\n  labs(title = \"PCoA of 180-SNP Genotypes\", x = \"Coordinate 1\", y = \"Coordinate 2\")\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Click to see plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](activity_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_all <- nj(dist_mat_all)\n\ntree_all <- ggtree(tree_all, layout = \"fan\") %<+% meta_ord +\n  geom_tippoint(aes(color = country), size = 2) +\n  scale_color_viridis_d() +\n  theme_tree2() +\n  labs(title = \"Neighbor-Joining Tree of P. falciparum Samples\")\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Click to see plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](activity_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n:::\n\n# Break: We will wait until everyone has completed this activity.\n",
    "supporting": [
      "activity_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}